{% include "base/includes/base.html" %}

{% block body %}
    <div class="row1">
        <div class="col-lg-5">
            <canvas id="chart"></canvas>
        </div>
    </div>

    <p hidden id="data">{{ json }}</p>

    {% block static_files %}
    <script>
        var json_data = JSON.parse(document.getElementById("data").textContent);
        const labels = [];
        const prices = [];

        json_data.forEach(element => {
            labels.push(element.city);
            prices.push(element.data);
        });

        const data = {
            labels: labels,
            datasets: [
            {
                label: 'Average Prices',
                data: prices,
                borderColor: "green",
                backgroundColor: "green",
            }          
            ]
        };

        const config = {
            type: 'bar',
            data: data,
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                    display: true,
                    text: 'Average Prices Per City'
                    }
                }
            },
        };

        

        var barChart = new Chart(
            document.getElementById('chart'),
            config
        );
    </script>
    {% endblock %}
{% endblock %}